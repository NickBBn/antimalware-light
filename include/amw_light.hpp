//
// Created by niickson on 7/3/21.
//

#ifndef ANTIMALWARE_LIGHT_AMW_LIGHT_HPP
#define ANTIMALWARE_LIGHT_AMW_LIGHT_HPP
#include <iostream>
#include <iomanip>
#include <string>
#include <filesystem>
#include <string>
#include <fstream>
#include <chrono>

namespace fs = std::filesystem;

class amw_light {
public:
    explicit amw_light(const std::string& path_to_dir);
    void scan();
    void print_results(std::ostream& out) const;

private:
    void scan_file(const fs::path& file);
    fs::path directory;
    size_t suspicious_js;
    size_t suspicious_unix;
    size_t suspicious_mac;
    size_t err_count;
    size_t files_count;
    size_t microsec_time;
};


#endif //ANTIMALWARE_LIGHT_AMW_LIGHT_HPP
